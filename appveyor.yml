version: 1.0.{build}
os: Visual Studio 2022

environment:
  matrix:
  - ARCH: x86

build_script:
- mkdir build
- cd build
- cmake -G "Visual Studio 17 2022" -A x64 .. -DCMAKE_CXX_FLAGS="-DEVE_NO_FORCEINLINE"
- cmake --build . --target unit.arch.exe      --config Debug
- cmake --build . --target unit.meta.exe      --config Debug
- cmake --build . --target unit.internals.exe --config Debug

test_script:
- ctest -C Debug --output-on-failure -R ^unit.arch.*.exe
- ctest -C Debug --output-on-failure -R ^unit.meta.*.exe
- ctest -C Debug --output-on-failure -R ^unit.internals.*.exe
